Project2
================
Chuanni He
2022-10-03

# Backgroun Information

This project is prepared by Aniket Anil Walimbe and Chuanni He. It
created a vignette for reading and summarizing data from one of the
[Financial data API](https://polygon.io/docs/getting-started).

# Requirements

To use the functions for interacting with the Financial API, We used the
following packages:  
\* `httr`: Tools for Working with URLs and HTTP \* `jsonlite`: A JSON
parser/generator optimized for the web. Its main strength is that it
implements a bidirectional mapping between JSON data and the most
important R data types.

``` r
# Required library and key information
key = "EByG3OEye377G2rI0LRah2CUjGplA7TB"
library(httr)
library(jsonlite)
```

# API Interaction Functions

This section talks about how we define the functions to interact with
the Financial API, as well as some helper functions working with data
manipulation.

`Aggregates`

Our first function is to obtain the highest price for a stock over a
given date range in custom time window sizes. This function interacts
with the `Aggregates (Bars)` endpoint of the API. `stock` parameter
refers to the ticker of the referred company. For example, the stock
ticker for Apple Inc.Â is `AAPL`. Either lower-case or capital letters
are acceptable. The second parameter `multiplier` refers to the time
multiplier for the acquired data. For example, if the `timespan` is
`day`, then `multiplier` of `5` indicates that 5-minute bars will be
obtained. `multiplier` should be integer values. The last parameter
`timespan` refers to the size of the time window. The possible values
are `minute`, `hour`, `day`, `week`, `month`, `quarter`, `year`. Either
lower-case or capital letters are acceptable. This function will return
the close price in the given time period between 2021-7-22 to 2022-7-22
with a maximum data length of 200 records. The returned data type is
data frame.

``` r
# timespan = (minute,hour,day,week,month,quarter,year)
Aggregates = function(stock,multiplier, timespan) {
  # generate the URL
  base = "https://api.polygon.io/v2/aggs/"
  Endpoint = "ticker"
  stock = toupper(stock)
  timespan = tolower(timespan)
  call = paste(base,Endpoint,"/",stock,"/range/",multiplier,"/",timespan,
               "/2021-07-22/2022-07-22?adjusted=true&sort=asc&limit=200&apiKey=",
               key, sep = "")
  # Acquire the data
  get = GET(call)
  content = content(get)
  # store and return the data
  price = data.frame()
  ## the close price
  close = c()
  for (i in 1:length(content$results)) {
    close = rbind(close,content$results[[i]]$c)
  }
  ## the highest price
  highest = c()
  for (i in 1:length(content$results)) {
    highest = rbind(highest,content$results[[i]]$h)
  }
  ## the lowest price
  lowest = c()
  for (i in 1:length(content$results)) {
    lowest = rbind(lowest,content$results[[i]]$l)
  }
  ## the open price
  open = c()
  for (i in 1:length(content$results)) {
    open = rbind(open,content$results[[i]]$o)
  }
  
  # Aggregate data into data frame
  price = data.frame(open = open, close = close, highest = highest, lowest = lowest)
  return(price)
}

stock = "aapl"
multiplier = 1
timespan = "day"
Aggregates(stock,multiplier,timespan)
```

    ##        open  close  highest   lowest
    ## 1   145.935 146.80 148.1950 145.8100
    ## 2   147.550 148.56 148.7177 146.9200
    ## 3   148.270 148.99 149.8300 147.7000
    ## 4   149.120 146.77 149.2100 145.5500
    ## 5   144.810 144.98 146.9700 142.5400
    ## 6   144.685 145.64 146.5500 144.5800
    ## 7   144.380 145.86 146.3300 144.1100
    ## 8   146.360 145.52 146.9500 145.2500
    ## 9   145.810 147.36 148.0450 145.1800
    ## 10  147.270 146.95 147.7900 146.2800
    ## 11  146.980 147.06 147.8400 146.1700
    ## 12  146.350 146.14 147.1100 145.6300
    ## 13  146.200 146.09 146.7000 145.5200
    ## 14  146.440 145.60 147.7100 145.3000
    ## 15  146.050 145.86 146.7200 145.5300
    ## 16  146.190 148.89 149.0500 145.8400
    ## 17  148.970 149.10 149.4444 148.2700
    ## 18  148.535 151.12 151.1900 146.4700
    ## 19  150.230 150.19 151.6800 149.0900
    ## 20  149.800 146.36 150.7200 146.1500
    ## 21  145.030 146.70 148.0000 144.5000
    ## 22  147.440 148.19 148.5000 146.7800
    ## 23  148.310 149.71 150.1900 147.8900
    ## 24  149.450 149.62 150.8600 149.1500
    ## 25  149.810 148.36 150.3200 147.8000
    ## 26  148.350 147.54 149.1200 147.5100
    ## 27  147.480 148.60 148.7500 146.8300
    ## 28  149.000 153.12 153.4900 148.6100
    ## 29  152.660 151.83 152.8000 151.2900
    ## 30  152.830 152.51 154.9800 152.3400
    ## 31  153.870 153.65 154.7200 152.4000
    ## 32  153.760 154.30 154.6300 153.0900
    ## 33  154.970 156.69 157.2600 154.3900
    ## 34  156.980 155.11 157.0400 153.9750
    ## 35  155.490 154.07 156.1100 153.9500
    ## 36  155.000 148.97 155.4800 148.7000
    ## 37  150.630 149.55 151.4200 148.7500
    ## 38  150.350 148.12 151.0700 146.9100
    ## 39  148.560 149.03 149.4400 146.3700
    ## 40  148.440 148.79 148.9700 147.2210
    ## 41  148.820 146.06 148.8200 145.7600
    ## 42  143.800 142.94 144.8400 141.2700
    ## 43  143.930 143.43 144.6000 142.7800
    ## 44  144.450 145.85 146.4300 143.7001
    ## 45  146.650 146.83 147.0800 145.6400
    ## 46  145.660 146.92 147.4701 145.5600
    ## 47  145.470 145.37 145.9600 143.8200
    ## 48  143.250 141.91 144.7500 141.6900
    ## 49  142.470 142.83 144.4500 142.0300
    ## 50  143.660 141.50 144.3780 141.2800
    ## 51  141.900 142.65 142.9200 139.1101
    ## 52  141.760 139.14 142.2100 138.2700
    ## 53  139.490 141.11 142.2400 139.3600
    ## 54  139.470 142.00 142.1500 138.3700
    ## 55  143.060 143.29 144.2150 142.7200
    ## 56  144.030 142.90 144.1781 142.5600
    ## 57  142.270 142.81 144.8100 141.8100
    ## 58  143.230 141.51 143.2500 141.0401
    ## 59  141.235 140.91 141.4000 139.2000
    ## 60  142.110 143.76 143.8800 141.5100
    ## 61  143.770 144.84 144.8950 143.5100
    ## 62  143.445 146.55 146.8400 143.1600
    ## 63  147.010 148.76 149.1700 146.5500
    ## 64  148.700 149.26 149.7539 148.1200
    ## 65  148.810 149.48 149.6400 147.8700
    ## 66  149.690 148.69 150.1800 148.6400
    ## 67  148.680 148.64 149.3700 147.6211
    ## 68  149.330 149.32 150.8400 149.0101
    ## 69  149.360 148.85 149.7300 148.4900
    ## 70  149.820 152.57 153.1650 149.7200
    ## 71  147.215 149.80 149.9400 146.4128
    ## 72  148.985 148.96 149.7000 147.8000
    ## 73  148.660 150.02 151.5700 148.6500
    ## 74  150.390 151.49 151.9700 149.8200
    ## 75  151.580 150.96 152.4300 150.6400
    ## 76  151.890 151.28 152.2000 150.0600
    ## 77  151.410 150.44 151.5700 150.1600
    ## 78  150.200 150.81 151.4280 150.0601
    ## 79  150.020 147.92 150.1300 147.8500
    ## 80  148.960 147.87 149.4300 147.6810
    ## 81  148.430 149.99 150.4000 147.4800
    ## 82  150.370 150.00 151.8800 149.4300
    ## 83  149.940 151.00 151.4880 149.3400
    ## 84  150.995 153.49 155.0000 150.9900
    ## 85  153.710 157.87 158.6700 153.0500
    ## 86  157.650 160.55 161.0200 156.5328
    ## 87  161.680 161.02 165.7000 161.0000
    ## 88  161.120 161.41 161.8000 159.0601
    ## 89  160.750 161.94 162.1400 159.6400
    ## 90  159.565 156.81 160.4500 156.3600
    ## 91  159.370 160.24 161.1900 158.7901
    ## 92  159.985 165.30 165.5200 159.9200
    ## 93  167.480 164.77 170.3000 164.5300
    ## 94  158.735 163.76 164.2000 157.8000
    ## 95  164.020 161.84 164.9600 159.7200
    ## 96  164.290 165.32 167.8799 164.2800
    ## 97  169.080 171.18 171.5800 168.3400
    ## 98  172.125 175.08 175.9600 170.7000
    ## 99  174.910 174.56 176.7500 173.9200
    ## 100 175.205 179.45 179.6300 174.6900
    ## 101 181.115 175.74 182.1300 175.5300
    ## 102 175.250 174.33 177.7400 172.2100
    ## 103 175.110 179.30 179.5000 172.3108
    ## 104 179.280 172.26 181.1400 170.7500
    ## 105 169.930 171.14 173.4700 169.6900
    ## 106 168.280 169.75 170.5800 167.4600
    ## 107 171.555 172.99 173.2000 169.1200
    ## 108 173.040 175.64 175.8600 172.1500
    ## 109 175.850 176.28 176.8499 175.2700
    ## 110 177.085 180.33 180.4200 177.0700
    ## 111 180.160 179.29 181.3300 178.5300
    ## 112 179.330 179.38 180.6300 178.1400
    ## 113 179.470 178.20 180.5700 178.0900
    ## 114 178.085 177.57 179.2300 177.2600
    ## 115 177.830 182.01 182.8800 177.7100
    ## 116 182.630 179.70 182.9400 179.1200
    ## 117 179.610 174.92 180.1700 174.6400
    ## 118 172.700 172.00 175.3000 171.6400
    ## 119 172.890 172.17 174.1400 171.0300
    ## 120 169.080 172.19 172.5000 168.1700
    ## 121 172.320 175.08 175.1800 170.8200
    ## 122 176.120 175.53 177.1800 174.8200
    ## 123 175.780 172.19 176.6200 171.7900
    ## 124 171.340 173.07 173.7800 171.0900
    ## 125 171.510 169.80 172.5400 169.4050
    ## 126 170.000 166.23 171.0800 165.9400
    ## 127 166.980 164.51 169.6800 164.1800
    ## 128 164.415 162.41 166.3300 162.3000
    ## 129 160.020 161.62 162.3000 154.7000
    ## 130 158.980 159.78 162.7600 157.0200
    ## 131 163.500 159.69 164.3894 157.8200
    ## 132 162.450 159.22 163.8400 158.2800
    ## 133 165.710 170.33 170.3500 162.8000
    ## 134 170.160 174.78 175.0000 169.5100
    ## 135 174.010 174.61 174.8400 172.3100
    ## 136 174.745 175.84 175.8800 173.3300
    ## 137 174.480 172.90 176.2399 172.1200
    ## 138 171.680 172.39 174.1000 170.6800
    ## 139 172.860 171.66 173.9458 170.9500
    ## 140 171.730 174.83 175.3500 171.4300
    ## 141 176.050 176.28 176.6500 174.9000
    ## 142 174.140 172.12 175.4800 171.5500
    ## 143 172.330 168.64 173.0800 168.0400
    ## 144 167.370 168.88 169.5800 166.5600
    ## 145 170.970 172.79 172.9500 170.2500
    ## 146 171.850 172.55 173.3400 170.0500
    ## 147 171.030 168.88 171.9100 168.4700
    ## 148 169.820 167.30 170.5413 166.1900
    ## 149 164.980 164.32 166.6900 162.1500
    ## 150 165.540 160.07 166.1500 159.7500
    ## 151 152.580 162.74 162.8500 152.0000
    ## 152 163.840 164.85 165.1200 160.8738
    ## 153 163.060 165.12 165.4200 162.4300
    ## 154 164.695 163.20 166.6000 161.9700
    ## 155 164.390 166.56 167.3600 162.9500
    ## 156 168.470 166.23 168.9100 165.5500
    ## 157 164.490 163.17 165.5500 162.1000
    ## 158 163.360 159.30 165.0200 159.0400
    ## 159 158.820 157.44 162.8800 155.8000
    ## 160 161.475 162.95 163.4100 159.4100
    ## 161 160.200 158.52 160.3900 155.9800
    ## 162 158.930 154.73 159.2800 154.5000
    ## 163 151.450 150.62 154.1200 150.1000
    ## 164 150.900 155.09 155.5700 150.3800
    ## 165 157.050 159.59 160.0000 154.4600
    ## 166 158.610 160.62 161.0000 157.6300
    ## 167 160.510 163.98 164.4800 159.7600
    ## 168 163.510 165.38 166.3500 163.0150
    ## 169 165.510 168.82 169.4200 164.9100
    ## 170 167.990 170.21 172.6400 167.6500
    ## 171 171.060 174.07 174.1400 170.2100
    ## 172 173.880 174.72 175.2800 172.7500
    ## 173 172.170 175.60 175.7300 172.0000
    ## 174 176.690 178.96 179.0100 176.3400
    ## 175 178.550 177.77 179.6100 176.7000
    ## 176 177.840 174.61 178.0300 174.4000
    ## 177 174.030 174.31 174.8800 171.9400
    ## 178 174.570 178.44 178.4900 174.4400
    ## 179 177.500 175.06 178.3000 174.4150
    ## 180 172.360 171.83 173.6300 170.1300
    ## 181 171.160 172.14 173.3600 169.8500
    ## 182 171.780 170.09 171.7800 169.2000
    ## 183 168.710 165.75 169.0300 165.5000
    ## 184 168.020 167.66 169.8700 166.6400
    ## 185 167.390 170.40 171.0400 166.7700
    ## 186 170.620 165.29 171.2700 165.0400
    ## 187 163.920 165.07 166.5984 163.5700
    ## 188 165.020 167.40 167.8200 163.9100
    ## 189 168.760 167.23 168.8800 166.1000
    ## 190 168.910 166.42 171.5300 165.9100
    ## 191 166.460 161.79 167.8699 161.5000
    ## 192 161.120 162.88 163.1700 158.4600
    ## 193 162.250 156.80 162.3400 156.7200
    ## 194 155.910 156.57 159.7900 155.3800
    ## 195 159.250 163.64 164.5150 158.9300
    ## 196 161.840 157.65 166.2000 157.2500
    ## 197 156.710 157.96 158.2300 153.2700
    ## 198 158.150 159.48 160.7100 156.3200
    ## 199 159.670 166.02 166.4800 159.2600
    ## 200 163.850 156.77 164.0800 154.9500
